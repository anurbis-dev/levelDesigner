# Dialog System Architecture

## üìã –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –¥–∏–∞–ª–æ–≥–æ–≤ Level Editor –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –≤—Å–µ—Ö –≤—Å–ø–ª—ã–≤–∞—é—â–∏—Ö –æ–∫–æ–Ω —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –≤—ã—Å–æ—Ç–æ–π –∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π —à–∏—Ä–∏–Ω–æ–π.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### BaseDialog
**–§–∞–π–ª**: `src/ui/BaseDialog.js`

–ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –≤—Å–µ—Ö –≤—Å–ø–ª—ã–≤–∞—é—â–∏—Ö –æ–∫–æ–Ω, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–∏–π:
- –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—É—é –≤—ã—Å–æ—Ç—É –ø–æ —Ä–∞–∑–º–µ—Ä—É –æ–∫–Ω–∞ –±—Ä–∞—É–∑–µ—Ä–∞
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫—É—é —à–∏—Ä–∏–Ω—É –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- –ú–æ–±–∏–ª—å–Ω—É—é –∞–¥–∞–ø—Ç–∞—Ü–∏—é
- –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–æ–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å—Ç–∏–ª–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è–º–∏
- **–ü–ª–∞–≤–Ω—É—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –±–µ–∑ —Å–∫–∞—á–∫–æ–≤ —Ä–∞–∑–º–µ—Ä–æ–≤**

### DialogStructures
**–§–∞–π–ª**: `src/ui/panel-structures/DialogStructures.js`

–ü—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–∏–∞–ª–æ–≥–æ–≤:
- `StandardDialogStructure` - –±–∞–∑–æ–≤—ã–π –¥–∏–∞–ª–æ–≥
- `SettingsDialogStructure` - –¥–∏–∞–ª–æ–≥ –Ω–∞—Å—Ç—Ä–æ–µ–∫
- `ActorPropertiesDialogStructure` - –¥–∏–∞–ª–æ–≥ —Å–≤–æ–π—Å—Ç–≤ –∞–∫—Ç–µ—Ä–∞
- `UniversalDialogStructure` - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –¥–∏–∞–ª–æ–≥
- `FolderPickerDialogStructure` - –¥–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ –ø–∞–ø–∫–∏
- `GridSettingsDialogStructure` - –¥–∏–∞–ª–æ–≥ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Å–µ—Ç–∫–∏

### SettingsSectionConstructor
**–§–∞–π–ª**: `src/ui/panel-structures/SettingsSectionConstructor.js`

–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–µ–∫—Ü–∏–π SettingsPanel —Å –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–º —Å—Ç–∏–ª–µ–º:
- `createSettingsSection()` - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–µ–∫—Ü–∏–∏ —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º
- `createSettingsFormGroup()` - —Å–æ–∑–¥–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Ñ–æ—Ä–º—ã
- `createSettingsGrid()` - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ç–∫–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- `createSettingsCheckbox()` - —Å–æ–∑–¥–∞–Ω–∏–µ —á–µ–∫–±–æ–∫—Å–∞ —Å –ª–µ–π–±–ª–æ–º
- `createSettingsRange()` - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–ª–∞–π–¥–µ—Ä–∞ —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –∑–Ω–∞—á–µ–Ω–∏—è
- `createSettingsColorInput()` - —Å–æ–∑–¥–∞–Ω–∏–µ —Ü–≤–µ—Ç–æ–≤–æ–≥–æ —Å–µ–ª–µ–∫—Ç–æ—Ä–∞
- `createSettingsInput()` - —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—è
- `createSettingsLabel()` - —Å–æ–∑–¥–∞–Ω–∏–µ –ª–µ–π–±–ª–∞

## üîÑ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞ Settings Panel
- **–í—Å–µ –º–µ—Ç–æ–¥—ã render** –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã –Ω–∞ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—ã
- **–£–¥–∞–ª–µ–Ω –¥—É–±–ª–∏—Ä—É—é—â–∏–π –∫–æ–¥** (~400+ —Å—Ç—Ä–æ–∫ HTML)
- **DialogSizeManager –æ–±–Ω–æ–≤–ª–µ–Ω** –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
- **–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ stateManager** –≤ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ä–µ–Ω–¥–µ—Ä–µ—Ä–∞—Ö

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- `renderGeneralSettings()` ‚Üí `renderGeneralSettingsRefactored()`
- `renderColorsSettings()` ‚Üí `renderColorsSettingsRefactored()`
- `renderSelectionSettings()` ‚Üí `renderSelectionSettingsRefactored()`
- `renderCameraSettings()` ‚Üí `renderCameraSettingsRefactored()`
- `renderAssetsSettings()` ‚Üí `renderAssetsSettingsRefactored()`
- `renderPerformanceSettings()` ‚Üí `renderPerformanceSettingsRefactored()`

### DialogSizeManager
- **–î–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `stateManager`** –¥–ª—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ä–µ–Ω–¥–µ—Ä–µ—Ä–æ–≤
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ** —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –ø–æ –∏–º–µ–Ω–∏
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–¥–∞—á–∏ stateManager** –≤ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- **–û–±–Ω–æ–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `updateDialogSize()`** –≤ SettingsPanel

## ‚ö†Ô∏è –ü—Ä–∏–Ω—Ü–∏–ø—ã

- **SettingsPanel –≤—Å–µ–≥–¥–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å levelEditor** - –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ `stateManager` –∏–∑–±—ã—Ç–æ—á–Ω—ã
- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ** –æ—Ç BaseDialog
- **–ù–ï –¥—É–±–ª–∏—Ä—É–π—Ç–µ –ª–æ–≥–∏–∫—É** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ super.method()
- **–ù–ï –¥–æ–±–∞–≤–ª—è–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫–∏** `if (!stateManager)` - —ç—Ç–æ –Ω–∞—Ä—É—à–∞–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```javascript
// –ü—Ä–æ—Å—Ç–æ–π –¥–∏–∞–ª–æ–≥
const config = {
    ...getDialogStructure('standard'),
    title: 'My Dialog',
    contentRenderer: () => '<div>Content</div>'
};
const dialog = new BaseDialog(config);
dialog.show();
```

## CSS –∫–ª–∞—Å—Å—ã

- `.dialog-overlay` - –æ–≤–µ—Ä–ª–µ–π
- `.dialog-container` - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
- `.dialog-header` - –∑–∞–≥–æ–ª–æ–≤–æ–∫
- `.dialog-content` - –∫–æ–Ω—Ç–µ–Ω—Ç
- `.dialog-footer` - –ø–æ–¥–≤–∞–ª

## –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

- `id` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
- `title` - –∑–∞–≥–æ–ª–æ–≤–æ–∫
- `width` - —à–∏—Ä–∏–Ω–∞ (auto)
- `height` - –≤—ã—Å–æ—Ç–∞ (calc(100vh - 4rem))
- `showCloseButton` - –∫–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è
- `showFooter` - –ø–æ–¥–≤–∞–ª
- `footerButtons` - –∫–Ω–æ–ø–∫–∏ –ø–æ–¥–≤–∞–ª–∞
- `contentRenderer` - —Ñ—É–Ω–∫—Ü–∏—è —Ä–µ–Ω–¥–µ—Ä–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
